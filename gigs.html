---
title: Gigs
---

<a
  href='/calendar.ics'
  class='btn btn-info cal-subscribe'
  data-toggle='tooltip'
  data-placement='bottom'
  title='Add our gig schedule to your calendar'>
  Gig calendar
</a>

<h2>Upcoming</h2>
<dl
  id='giglist'
  class='row'></dl>

<h2>Archive</h2>
<div
  id='archive-buttons'
  class='row'></div>
<div id='archive'></div>

<script>
gigs = [
  {% for gig in site.categories.gigs %}
  {
    'title': '{{ gig.title }}',
    'date': '{{ gig.date | date: "%Y-%m-%d" }}',
    'url': '{{ gig.url }}'
  },
  {% endfor %}
]

nothingPlanned = true
$.each(gigs, function(index, gig) {
  date = fancyDate(gig.date)

  dt = '<dt class="col-6">' + date + '</dt>'
  dd = '<dd class="col-6"><a href="' + gig.url + '">' + gig.title + '</a></dd>'

  if (isFuture(gig.date)) {
    nothingPlanned = false
    dt = '<dt class="col-6">' + date + '</dt>'
    dd = '<dd class="col-6"><a href="' + gig.url + '">' + gig.title + '</a></dd>'
    target = '#giglist'
    $(target).append(dt + dd)
  } else {
    year = moment(gig.date).format('YYYY')
    arch = 'archive-' + year
    if (! $('#' + arch).length) {
      $('#archive-buttons').append(`
      <div class='col-4 col-md text-center'>
        <button
          type='button'
          class='btn btn-info'
          data-toggle='modal'
          data-target='#${ arch }-modal'>
          ${ year }
        </button>
      </div>
      `)
      $('#archive').append(`
        <div
          class="modal fade"
          id="${ arch }-modal"
          tabindex="-1"
          role="dialog"
          aria-hidden="true">
          <div
            class="modal-dialog"
            role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h2>${ year } gigs</h2>
              </div>
              <div class="modal-body row" id='${ arch }'>
              </div>
              <div class="modal-footer">
              <button
                type="button"
                class="btn btn-info"
                data-dismiss="modal">
                Close
              </button>
            </div>
          </div>
        </div>
      `)
    }
    content = `
    <div class='col-md'>
      <div class='card'>
        <h4>${ date }</h4>
        <h3>
          <a href="${ gig.url }">
            ${ gig.title }
          </a>
        </h3>
      </div>
    </div>
    `
    $('#' + arch).append(content)
  }

})

if (nothingPlanned) {
  $(`<p class="text-center">
    Nothing in the calendar. Why not
    <a href="/book-the-band/">book us?</a></p>
  `).insertBefore('#giglist')
}

function fancyDate(isoDate) {
  format = 'Do MMMM YYYY'
  if (isFuture(isoDate)) {
    format = 'dddd Do MMMM'
  }
  return moment(isoDate).format(format)
}

function isFuture(date) {
  return moment().isBefore(date)
}
</script>
